<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-installation" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Installation | OP-SQLite Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://op-engineering.github.io/op-sqlite/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://op-engineering.github.io/op-sqlite/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://op-engineering.github.io/op-sqlite/docs/installation"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Installation | OP-SQLite Docs"><meta data-rh="true" name="description" content="Just install and run. In the latest RN versions, pod installation should be automatic but if not run pod install manually."><meta data-rh="true" property="og:description" content="Just install and run. In the latest RN versions, pod installation should be automatic but if not run pod install manually."><link data-rh="true" rel="icon" href="/op-sqlite/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://op-engineering.github.io/op-sqlite/docs/installation"><link data-rh="true" rel="alternate" href="https://op-engineering.github.io/op-sqlite/docs/installation" hreflang="en"><link data-rh="true" rel="alternate" href="https://op-engineering.github.io/op-sqlite/docs/installation" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Installation","item":"https://op-engineering.github.io/op-sqlite/docs/installation"}]}</script><link rel="stylesheet" href="/op-sqlite/assets/css/styles.66eae5c3.css">
<script src="/op-sqlite/assets/js/runtime~main.594e5554.js" defer="defer"></script>
<script src="/op-sqlite/assets/js/main.ba6516b4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/op-sqlite/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/op-sqlite/"><div class="navbar__logo"><img src="/op-sqlite/img/logo.svg" alt="OP SQLite Documentation" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/op-sqlite/img/logo.svg" alt="OP SQLite Documentation" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">OP-SQLite</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/op-sqlite/docs/installation">Docs</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/OP-Engineering/op-sqlite" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/op-sqlite/docs/installation"><span title="Installation" class="linkLabel_WmDU">Installation</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/op-sqlite/docs/configuration"><span title="Configuration" class="linkLabel_WmDU">Configuration</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/op-sqlite/docs/gotchas"><span title="Gotchas" class="linkLabel_WmDU">Gotchas</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/op-sqlite/docs/debugging"><span title="Debugging" class="linkLabel_WmDU">Debugging</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/op-sqlite/docs/reactive_queries"><span title="Reactive Queries" class="linkLabel_WmDU">Reactive Queries</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/op-sqlite/docs/tokenizers"><span title="Custom Tokenizers" class="linkLabel_WmDU">Custom Tokenizers</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/op-sqlite/docs/key_value_storage"><span title="Key-Value Storage" class="linkLabel_WmDU">Key-Value Storage</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/op-sqlite/docs/api"><span title="API Reference" class="linkLabel_WmDU">API Reference</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/op-sqlite/docs/ORM_Libs"><span title="ORMs &amp; Libs" class="linkLabel_WmDU">ORMs &amp; Libs</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/op-sqlite/docs/cpp_usage"><span title="C++ Usage" class="linkLabel_WmDU">C++ Usage</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/op-sqlite/docs/Libsql/start"><span title="Libsql" class="categoryLinkLabel_W154">Libsql</span></a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/op-sqlite/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Installation</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Installation</h1></header>
<p>Just install and run. In the latest RN versions, pod installation should be automatic but if not run <code>pod install</code> manually.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">npm i -s @op-engineering/op-sqlite</span><br></span></code></pre></div></div>
<p>You cannot use this library on a expo-go app, you need to pre-build your app. No expo plugin is needed, just make sure the pods are properly setup.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">npx expo install @op-engineering/op-sqlite</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">npx expo prebuild --clean</span><br></span></code></pre></div></div>
<p>This package only runs on <code>iOS</code>, <code>Android</code> and <code>macOS</code>.</p>
<h1>Configuration</h1>
<p>SQLite is very customizable on compilation level. op-sqlite also allows you add extensions or even change the base implementation. You can do this by adding the following to your <code>package.json</code>:</p>
<blockquote>
<p>[!IMPORTANT]
When using a monorepo, be sure to add the &quot;op-sqlite&quot; config to the monorepo root <code>package.json</code> file.
This is necessary because the <code>node_modules/@op-engineering/op-sqlite/op-sqlite.podspec</code> will search for first the <code>package.json</code> file in a parent directory.
Alternative, you may be able to solve this by blocking this package from being hoisted to the root <code>node_modules</code>.
Check your ios/Podfile.lock to see where it&#x27;s being installed.</p>
</blockquote>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ... the rest of your package.json</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// All the keys are optional, see the usage below</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;op-sqlite&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;sqlcipher&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// &quot;crsqlite&quot;: false,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// &quot;performanceMode&quot;: true,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// &quot;iosSqlite&quot;: false,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// &quot;sqliteFlags&quot;: &quot;-DSQLITE_DQS=0 -DSQLITE_MY_FLAG=1&quot;,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// &quot;fts5&quot;: true,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// &quot;rtree&quot;: true,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// &quot;libsql&quot;: true,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// &quot;sqliteVec&quot;: true,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// &quot;tokenizers&quot;: [&quot;simple_tokenizer&quot;]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>All keys are optional, only turn on the features you want:</p>
<ul>
<li class=""><code>sqlcipher</code> allows to change the base sqlite implementation to <a href="https://www.zetetic.net/sqlcipher/" target="_blank" rel="noopener noreferrer" class="">sqlcipher</a>, which encrypts all the database data with minimal overhead. You will still need to keep your encryption key secure. Read more about security in React Native <a href="https://ospfranco.com/react-native-security-guide/" target="_blank" rel="noopener noreferrer" class="">here</a>.</li>
<li class=""><code>crsqlite</code> is an extension that allows replication to a server backed sqlite database copy. <a href="https://github.com/vlcn-io/cr-sqlite" target="_blank" rel="noopener noreferrer" class="">Repo here</a>.</li>
<li class=""><code>performanceMode</code> turns on certain compilation flags that make sqlite speedier at the cost of disabling some features. You should almost always turn this on, but test your app thoroughly.</li>
<li class=""><code>iosSqlite</code> uses the embedded iOS version from sqlite, which saves disk space but may use an older version and cannot load extensions as Apple disables it due to security concerns. On Android SQLite is always compiled from source as each vendor messes with sqlite or uses outdated versions.</li>
<li class=""><code>sqliteFlags</code> allows you to pass your own compilation flags to further disable/enable features and extensions. It follows the C flag format: <code>-D[YOUR_FLAG]=[YOUR_VALUE]</code>. If you are running large queries on large databases sometimes on Android devices you might get a IO exception. You can disable temporary files by using adding the <code>&quot;-DSQLITE_TEMP_STORE=2&quot;</code> flag.</li>
<li class=""><code>fts5</code> enables the full <a href="https://www.sqlite.org/fts5.html" target="_blank" rel="noopener noreferrer" class="">text search extension</a>.</li>
<li class=""><code>tokenizers</code> allows you to write your own C tokenizers. Read more in the corresponding section in this documentation.</li>
<li class=""><code>rtree</code> enables the <a href="https://www.sqlite.org/rtree.html" target="_blank" rel="noopener noreferrer" class="">rtree extension</a></li>
<li class=""><code>sqliteVec</code> enables <a href="https://github.com/asg017/sqlite-vec" target="_blank" rel="noopener noreferrer" class="">sqlite-vec</a>, an extension for RAG embeddings</li>
</ul>
<p>Some combination of features are not allowed. For example <code>sqlcipher</code> and <code>iosSqlite</code> since they are fundamentally different sources. In this cases you will get an error while doing a pod install or during the Android build.</p>
<h1>Conflicts</h1>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="use_frameworks">use_frameworks<a href="#use_frameworks" class="hash-link" aria-label="Direct link to use_frameworks" title="Direct link to use_frameworks" translate="no">​</a></h2>
<p>In case you are using <code>use_frameworks</code> (for example if you are using <code>react-native-firebase</code>), this will break the compilation process and force the compilation to use the embedded sqlite on iOS. One possible workaround is forcing <code>op-sqlite</code> to be compiled statically, you can modify the <code>Podfile</code> as:</p>
<div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pre_install do |installer|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  installer.pod_targets.each do |pod|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if pod.name.eql?(&#x27;op-sqlite&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      def pod.build_type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Pod::BuildType.static_library</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre></div></div>
<p>If you are using Expo CNG you can use the <a href="https://github.com/jonshaffer/expo-plugin-ios-static-libraries?tab=readme-ov-file#installation" target="_blank" rel="noopener noreferrer" class=""><code>expo-plugin-ios-static-libraries</code></a> plugin to automate adding the static setting for op-sqlite</p>
<p>It forces static compilation on <code>op-sqlite</code> only. Since everything is compiled from sources this <em>should</em> work, however do it at your own risk since other compilation errors might arise.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="compilation-clashes">Compilation clashes<a href="#compilation-clashes" class="hash-link" aria-label="Direct link to Compilation clashes" title="Direct link to Compilation clashes" translate="no">​</a></h2>
<p>If you have other packages that are dependent on sqlite you will have issues. Some of the known offenders are:</p>
<ul>
<li class=""><code>expo-updates</code></li>
<li class=""><code>expo-sqlite</code></li>
<li class=""><code>cozodb</code></li>
<li class="">Other packages that try to add/link sqlite (or the sqlite3 cocoapod)</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="expo-updates">Expo Updates<a href="#expo-updates" class="hash-link" aria-label="Direct link to Expo Updates" title="Direct link to Expo Updates" translate="no">​</a></h3>
<p><code>expo-updates</code> now has a added a new way to avoid a hard dependency on sqlite. Adding <code>&quot;expo.updates.useThirdPartySQLitePod&quot;: &quot;true&quot;</code> to <code>ios/Podfile.properties.json</code> fixes the duplicate symbols and header definition issues when <code>expo-updates</code> is the only conflicting package.</p>
<p>An expo plugin can also be used:</p>
<div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> type </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token maybe-class-name">ConfigPlugin</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@expo/config-plugins&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> withPodfileProperties </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@expo/config-plugins&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">withUseThirdPartySQLitePod</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">ConfigPlugin</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">never</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"> = (expoConfig) =&gt; </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">withPodfileProperties</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">expoConfig</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">modResults</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">modResults</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">&#x27;expo.updates.useThirdPartySQLitePod&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;true&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> config</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain-text">;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">export default withUseThirdPartySQLitePod;</span><br></span></code></pre></div></div>
<p>If you cannot remove the dependency each of the packages will try to compile sqlite from sources or link it on build time. Even if they manage to compile, they might compile sqlite with different compilation flags and you might face runtime errors.</p>
<p>Another workaround for the expo packages, is you can use the iOS embedded version of sqlite for op-sqlite, in your <code>package.json</code> turn on the <code>iosSqlite</code> flag:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token property" style="color:#36acaa">&quot;op-sqlite&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;iosSqlite&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>This means however, you will be used whatever version the phone is running, which might be outdated and it also does not support extension loading. There is no way around this.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="libsql-and-expo-updates">Libsql and Expo Updates<a href="#libsql-and-expo-updates" class="hash-link" aria-label="Direct link to Libsql and Expo Updates" title="Direct link to Libsql and Expo Updates" translate="no">​</a></h3>
<p>If you want to use <code>expo-updates</code> and <code>libsql</code> at the same time there is one more workaround you need to apply. On your <code>AppDelegate</code> (or wherever you initialize your RN view if it&#x27;s a brownfield integration), you need to call <code>[OPSQLite expoUpdatesWorkaround];</code> before initializing the RN view. In case of a normal expo app modify the <code>AppDelegate.mm</code> as follows:</p>
<div class="language-objective-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-objective-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#import &quot;OPSQLite.h&quot; // Add the header</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Modify the didFinishLaunchingWithOptions function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-(BOOL)application: (UIApplication *)application didFinishLaunchingWithOptions: (NSDictionary *)launchOptions {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  self moduleName = @&quot;main&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  self.initialProps = 0{};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Add the call to the workaround</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [OPSQLite expoUpdatesWorkaround];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return [super application:application didFinishLaunchingWithOptions:launchOptions];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="error-base-module-not-found-did-you-do-a-pod-installclear-the-gradle-cache">[Error: Base module not found. Did you do a pod install/clear the gradle cache?]<a href="#error-base-module-not-found-did-you-do-a-pod-installclear-the-gradle-cache" class="hash-link" aria-label="Direct link to [Error: Base module not found. Did you do a pod install/clear the gradle cache?]" title="Direct link to [Error: Base module not found. Did you do a pod install/clear the gradle cache?]" translate="no">​</a></h2>
<p>If you are running into this issue, you have to clear the gradle cache. It is stored inside of the <a href="https://docs.gradle.org/current/userguide/directory_layout.html#dir:gradle_user_home" target="_blank" rel="noopener noreferrer" class="">gradle user home directory</a>, in the <code>caches/</code> directory. Removing the <code>caches/</code> directory and rebuilding your app should be enough to fix the error.</p>
<h1>Other</h1>
<p>For other conflicts and compilation errors there is no documented solutions. You need to get rid of the double compilation by hand, either by patching the compilation of each package so that it still builds or removing the dependency on the package.</p>
<p>On Android you might be able to get away by just <a href="https://ospfranco.com/how-to-resolve-duplicated-libraries-on-android/" target="_blank" rel="noopener noreferrer" class="">using a <code>pickFirst</code> strategy</a>. On iOS depending on the build system you might be able to patch it via a post-build hook, something like:</p>
<div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pre_install do |installer|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	installer.pod_targets.each do |pod|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		if pod.name.eql?(&#x27;expo-updates&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">			# Modify the configuration of the pod so it doesn&#x27;t depend on the sqlite pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/OP-Engineering/op-sqlite/blob/main/docs/installation.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--next" href="/op-sqlite/docs/configuration"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Configuration</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#use_frameworks" class="table-of-contents__link toc-highlight">use_frameworks</a></li><li><a href="#compilation-clashes" class="table-of-contents__link toc-highlight">Compilation clashes</a><ul><li><a href="#expo-updates" class="table-of-contents__link toc-highlight">Expo Updates</a></li><li><a href="#libsql-and-expo-updates" class="table-of-contents__link toc-highlight">Libsql and Expo Updates</a></li></ul></li><li><a href="#error-base-module-not-found-did-you-do-a-pod-installclear-the-gradle-cache" class="table-of-contents__link toc-highlight">[Error: Base module not found. Did you do a pod install/clear the gradle cache?]</a></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>